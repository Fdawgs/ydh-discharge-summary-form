"use strict";function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}var h=a.apply(b,c);f(void 0)})}}var request=require("request-promise");/**
 * @author Frazer Smith
 * @param {Object} config - FHIR API endpoint access config values.
 * @return {Function} express middleware
 * @description Queries FHIR API endpoints for AllergyIntolerance Resource
 * using MRN and admission date.
 */module.exports=function(a){return(/*#__PURE__*/function(){var b=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function b(c,d,e){var f;return regeneratorRuntime.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(f="",""===c.customparams.patient_mrn||""===c.customparams.admission_date||""===c.customparams.discharge_date){b.next=7;break}return f="".concat(a.url,"AllergyIntolerance?patient=").concat(c.customparams.patient_mrn,"&date=ge").concat(c.customparams.admission_date,"&date=le").concat(c.customparams.discharge_date),b.next=5,request.get(f,a.options).then(function(a){"Bundle"===a.resourceType?0===a.total?e():(c.customparams.allergies=a.entry,e()):e()})["catch"](function(a){e(a)});case 5:b.next=8;break;case 7:e();case 8:case"end":return b.stop();}},b)}));return function(){return b.apply(this,arguments)}}())};